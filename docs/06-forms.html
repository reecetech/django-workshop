<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Forms - Django Workshop</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li><a href="01-installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li><a href="02-creating-a-project.html"><strong aria-hidden="true">2.</strong> Creating a Project</a></li><li><a href="03-views-templates-and-urls.html"><strong aria-hidden="true">3.</strong> Views, Templates and URLs</a></li><li><a href="04-models-and-admin.html"><strong aria-hidden="true">4.</strong> Models &amp; Django Admin</a></li><li><a href="05-querying-and-displaying-models.html"><strong aria-hidden="true">5.</strong> Querying &amp; Displaying Models</a></li><li><a href="06-forms.html" class="active"><strong aria-hidden="true">6.</strong> Forms</a></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Django Workshop</h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="#forms" id="forms"><h1>Forms</h1></a>
<p>Now that we can view our blog posts, it would be nice to be able to create them through our website.</p>
<p>To enable this we will create a new page which will use a <code>ModelForm</code> to generate a HTML form that users
can fill out to create a new post.</p>
<p>Let's first create the template. Right-click on <code>blog/templates</code> and select <strong>New</strong>, <strong>HTML File</strong>.
Call the file <code>new_post.html</code>. Make the title <code>New Post</code> and add a heading of <code>&lt;h1&gt;New Post&lt;/h1&gt;</code>.
Your HTML should look like:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;New Post&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;New Post&lt;/h1&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Create a new view function in <code>blog/views.py</code> which renders our template:</p>
<pre><code class="language-python">def new_post(request):
    return render(request, &quot;new_post.html&quot;)
</code></pre>
<p>Next we need to create a url for this page. Open <code>myproject/urls.py</code> and add a path for the new page to
<code>urlpatterns</code>:</p>
<pre><code>urlpatterns = [
    path('admin/', admin.site.urls),
    path('', views.posts),
    path('new/', views.new_post),
]
</code></pre>
<p>We would like to be able to get to this page from the homepage so open <code>blog/template/posts.html</code>
and below the heading add a <code>&lt;a&gt;</code> tag:</p>
<pre><code class="language-html">&lt;body&gt;
    &lt;h1&gt;Welcome to {{ name }}'s Blog!&lt;/h1&gt;
    &lt;a href=&quot;/new/&quot;&gt;Create a new post&lt;/a&gt;
</code></pre>
<p>Test that everything works by refreshing your home page and following the link. You should see your
<code>New Post</code> heading.</p>
<p>We will create the form class in <code>blog/views.py</code> so open that file and at the top of the file import
the <code>ModelForm</code> base class:</p>
<pre><code class="language-python">from django.forms import ModelForm
</code></pre>
<p>At the bottom of the file, we will create a form class for our <code>Post</code> model by subclassing
<code>ModelForm</code> and linking it to our model using the <code>Meta</code> inner-class:</p>
<pre><code class="language-python">class PostForm(ModelForm):
    class Meta:
        model = Post
        fields = [&quot;title&quot;, &quot;body&quot;, &quot;public&quot;]
</code></pre>
<p>The <code>fields</code> attribute determines which fields on our model can be set using this form.</p>
<p>To render our form in the template we need to create a new instance in our view function and pass it
into our template:</p>
<pre><code class="language-python">def new_post(request):
    form = PostForm()
    return render(request, &quot;new_post.html&quot;, {&quot;form&quot;: form})
</code></pre>
<p>Then in <code>blog/templates/new_post.html</code> we render the form with <code>form.to_p</code>. This must go inside a
<code>&lt;form&gt;</code> tag with a CSRF token which is used to fix a security vulnerability:</p>
<pre><code class="language-html">&lt;body&gt;
    &lt;h1&gt;New Post&lt;/h1&gt;
    
    &lt;form method=&quot;POST&quot;&gt;
        {% csrf_token %}
        {{ form.as_p }}
        &lt;button&gt;Submit&lt;/button&gt;
    &lt;/form&gt;
&lt;/body&gt;
</code></pre>
<p>Refresh your New Post page and you should see the form. You can complete it and hit Submit but
currently it wont save because we haven't configured our view function to handle submissions.</p>
<p>Since the browser will use the <code>/new/</code> url for both fetching the HTML and for submitting the
form, both types of requests will be handled by our <code>new_post</code> view function. We can distinguish
which is which by looking at the HTTP request method. Requests for the HTML will have method <code>GET</code>
whereas submissions of the form will have method <code>POST</code>.</p>
<p>Configure your view function to use the <code>PostForm</code> class to save data from <code>POST</code> requests:</p>
<pre><code class="language-python">def new_post(request):
    if request.method == &quot;POST&quot;:
        form = PostForm(request.POST)
        form.save()
        return redirect(&quot;/&quot;)
    form = PostForm()
    return render(request, &quot;new_post.html&quot;, {&quot;form&quot;: form})
</code></pre>
<p>After the form is saved we redirect users back to the home page. You will need to import the
redirect function at the top of <code>blog/views.py</code>:</p>
<pre><code class="language-python">from django.shortcuts import render, redirect
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="05-querying-and-displaying-models.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="05-querying-and-displaying-models.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
            </nav>

        </div>

        

        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
